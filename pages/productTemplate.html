<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/a97e2a6b17.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" type="image/png" href="images/pageIcon.png">
    <link rel="stylesheet" href="css/pages/productTemplate.css">
    <title>Produto</title>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const myParam = urlParams.get('id');

        const loadProduct = () => {
            fetch(`/product?id=${myParam}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Erro na requisição');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log(data);
                    const productContainer = document.getElementById('product');
                    productContainer.innerHTML = '';
                    var rating = '';
                    for (let i = 0; i < product.Rating; i++) {
                        rating += '⭐';
                    }
                    const item = document.createElement('div');
                    item.className = 'img';
                    item.innerHTML = `<img src="https://via.placeholder.com/300" alt="">`;
                    const item2 = document.createElement('div');
                    item2.className = 'text';
                    item2.innerHTML = `${data.Name}</div>
                            <div class="rating">${rating}</div>
                            <div class="price">${data.Price}</div>
                            <button type="button" class="buyButton">Adicionar ao Carrinho</button>
                            <div class="description">Product description goes here. This is a placeholder text.</div>
                            <div class="shipping">
                                <label for="shipping">Calcular o frete</label>
                                <input type="text" name="shipping" id="shipping" placeholder="00000-000">
                            </div>`
                    productContainer.appendChild(item);
                    productContainer.appendChild(item2);
                })
                .catch(error => console.error('Erro ao carregar os produtos', error));
        }
        document.addEventListener('DOMContentLoaded', loadProduct);

    </script>

</head>

<body>
    <div class="contentContainer">
        <header>
            <div class="logo">
                <img src="images/logo.png" alt=">Alt+F4 Logo" onclick="location.href='index.html'">
            </div>
            <nav id="navBar">
                <ul class="menuBar">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="mobile.html">Mobile</a></li>
                    <li><a href="console.html">Console</a></li>
                    <li><a href="pc.html">PC</a></li>
                    <li><a href="suporte.html">Suporte</a></li>
                    <li><a href="sobreNos.html">Sobre nós</a></li>
                </ul>
            </nav>
            <div class="icons">
                <i class="fa-solid fa-circle-user colorIcons" onclick="location.href='login_registration.html'"></i>
                <i class="fa-solid fa-cart-shopping colorIcons" onclick="location.href='cart.html'"></i>
                <i id="menuButton" class="fa-solid fa-bars colorIcons"></i>
            </div>
        </header>
        <main>
            <div class="container" id="product"></div>
        </main>
        <div class="cartPopUp" id="cart">
            <div class="infoCart">
                <div class="title">
                    <i class="fa-regular fa-circle-check"></i>
                    <p>Adicionado ao carrinho</p>
                    <i class="fa-solid fa-xmark" id="close"></i>
                </div>
                <div class="middle">
                    <img src="https://placehold.co/70">
                    <div class="infoProduct">
                        <p>Nome Produto</p>
                        <p>Tamanho</p>
                        <p>R$000,0</p>
                    </div>
                </div>
                <button onclick="location.href='cart.html'">Ver carrinho</button>
            </div>
        </div>
        <script>
            document.getElementById('menuButton').addEventListener('click', function () {
                const nav = document.getElementById("navBar");
                const computedStyle = window.getComputedStyle(nav);
                const display = computedStyle.display;

                if (display === "none") {
                    nav.style.display = "flex";
                }
                else {
                    nav.style.display = "none";
                }
            });

            const buyButtons = document.getElementsByClassName('buyButton');
            for (let i = 0; i < buyButtons.length; i++) {
                buyButtons[i].addEventListener('click', function (event) {
                    event.preventDefault();
                    const cart = document.getElementById('cart');
                    const contentContainer = document.querySelector('.contentContainer');
                    document.body.classList.add('dimBackground');
                    contentContainer.classList.add('dimmed');
                    cart.style.display = "block";
                });
            }

            document.getElementById('close').addEventListener('click', function () {
                const cart = document.getElementById('cart');
                const contentContainer = document.querySelector('.contentContainer');
                document.body.classList.remove('dimBackground');
                contentContainer.classList.remove('dimmed');
                cart.style.display = 'none';
            });
        </script>
</body>

</html>